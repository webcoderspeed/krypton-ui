---
title: Command
description: Fast, composable, unstyled command menu for React. Built on top of cmdk.
component: true
---

## Installation

<CodePreview code="npx shadcn-ui@latest add command" language="bash" />

## Import

<CodePreview code="import { Command, CommandDialog, CommandEmpty, CommandGroup, CommandInput, CommandItem, CommandList, CommandSeparator, CommandShortcut } from '@/components/ui/command'" language="tsx" />

## Usage

### Basic Command

A simple command palette with basic functionality.

<CodePreview 
  code={`import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
} from "@/components/ui/command";

export default function CommandBasic() {
  return (
    <Command className="rounded-lg border shadow-md max-w-md">
      <CommandInput placeholder="Type a command or search..." />
      <CommandList>
        <CommandEmpty>No results found.</CommandEmpty>
        <CommandGroup heading="Suggestions">
          <CommandItem>
            <span>Calendar</span>
          </CommandItem>
          <CommandItem>
            <span>Search Emoji</span>
          </CommandItem>
          <CommandItem>
            <span>Calculator</span>
          </CommandItem>
        </CommandGroup>
      </CommandList>
    </Command>
  );
}`} 
  language="tsx" 
  preview={<CommandBasic />} 
/>

### Command Dialog

A command palette that opens in a dialog modal, perfect for global search functionality.

<CodePreview 
  code={`import { useState } from "react";
import {
  CommandDialog,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
  CommandSeparator,
  CommandShortcut,
} from "@/components/ui/command";
import { Button } from "@/components/ui/button";

export default function CommandDialogExample() {
  const [open, setOpen] = useState(false);

  return (
    <>
      <Button
        variant="outline"
        onClick={() => setOpen(true)}
        className="w-full justify-start text-sm text-muted-foreground"
      >
        <span className="inline-flex">Search documentation...</span>
        <CommandShortcut>âŒ˜K</CommandShortcut>
      </Button>
      <CommandDialog open={open} onOpenChange={setOpen}>
        <CommandInput placeholder="Type a command or search..." />
        <CommandList>
          <CommandEmpty>No results found.</CommandEmpty>
          <CommandGroup heading="Suggestions">
            <CommandItem>
              <span>Calendar</span>
            </CommandItem>
            <CommandItem>
              <span>Search Emoji</span>
            </CommandItem>
            <CommandItem>
              <span>Calculator</span>
            </CommandItem>
          </CommandGroup>
          <CommandSeparator />
          <CommandGroup heading="Settings">
            <CommandItem>
              <span>Profile</span>
              <CommandShortcut>âŒ˜P</CommandShortcut>
            </CommandItem>
            <CommandItem>
              <span>Billing</span>
              <CommandShortcut>âŒ˜B</CommandShortcut>
            </CommandItem>
            <CommandItem>
              <span>Settings</span>
              <CommandShortcut>âŒ˜S</CommandShortcut>
            </CommandItem>
          </CommandGroup>
        </CommandList>
      </CommandDialog>
    </>
  );
}`} 
  language="tsx" 
  preview={<CommandDialogExample />} 
/>

### Command Menu with Icons

Enhance your command palette with icons and keyboard shortcuts for better visual hierarchy.

<CodePreview 
  code={`import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
  CommandSeparator,
  CommandShortcut,
} from "@/components/ui/command";
import {
  Calculator,
  Calendar,
  CreditCard,
  Settings,
  Smile,
  User,
} from "lucide-react";

export default function CommandMenu() {
  return (
    <Command className="rounded-lg border shadow-md max-w-md">
      <CommandInput placeholder="Type a command or search..." />
      <CommandList>
        <CommandEmpty>No results found.</CommandEmpty>
        <CommandGroup heading="Suggestions">
          <CommandItem>
            <Calendar className="mr-2 h-4 w-4" />
            <span>Calendar</span>
          </CommandItem>
          <CommandItem>
            <Smile className="mr-2 h-4 w-4" />
            <span>Search Emoji</span>
          </CommandItem>
          <CommandItem>
            <Calculator className="mr-2 h-4 w-4" />
            <span>Calculator</span>
          </CommandItem>
        </CommandGroup>
        <CommandSeparator />
        <CommandGroup heading="Settings">
          <CommandItem>
            <User className="mr-2 h-4 w-4" />
            <span>Profile</span>
            <CommandShortcut>âŒ˜P</CommandShortcut>
          </CommandItem>
          <CommandItem>
            <CreditCard className="mr-2 h-4 w-4" />
            <span>Billing</span>
            <CommandShortcut>âŒ˜B</CommandShortcut>
          </CommandItem>
          <CommandItem>
            <Settings className="mr-2 h-4 w-4" />
            <span>Settings</span>
            <CommandShortcut>âŒ˜S</CommandShortcut>
          </CommandItem>
        </CommandGroup>
      </CommandList>
    </Command>
  );
}`} 
  language="tsx" 
  preview={<CommandMenu />} 
/>

### Searchable Command

A command palette that filters results based on user input, perfect for file browsers or search interfaces.

<CodePreview 
  code={`import { useState } from "react";
import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
} from "@/components/ui/command";
import {
  File,
  FileText,
  Folder,
  Image,
  Music,
  Video,
} from "lucide-react";

const files = [
  { name: "README.md", type: "file", icon: FileText },
  { name: "package.json", type: "file", icon: File },
  { name: "src", type: "folder", icon: Folder },
  { name: "components", type: "folder", icon: Folder },
  { name: "image.png", type: "image", icon: Image },
  { name: "song.mp3", type: "audio", icon: Music },
  { name: "video.mp4", type: "video", icon: Video },
  { name: "styles.css", type: "file", icon: File },
  { name: "index.html", type: "file", icon: FileText },
  { name: "utils", type: "folder", icon: Folder },
];

export default function CommandSearchable() {
  const [searchValue, setSearchValue] = useState("");

  const filteredFiles = files.filter((file) =>
    file.name.toLowerCase().includes(searchValue.toLowerCase())
  );

  return (
    <Command className="rounded-lg border shadow-md max-w-md">
      <CommandInput
        placeholder="Search files..."
        value={searchValue}
        onValueChange={setSearchValue}
      />
      <CommandList>
        <CommandEmpty>No files found.</CommandEmpty>
        <CommandGroup heading="Files">
          {filteredFiles.map((file) => {
            const Icon = file.icon;
            return (
              <CommandItem key={file.name}>
                <Icon className="mr-2 h-4 w-4" />
                <span>{file.name}</span>
              </CommandItem>
            );
          })}
        </CommandGroup>
      </CommandList>
    </Command>
  );
}`} 
  language="tsx" 
  preview={<CommandSearchable />} 
/>

### Command with Actions

Implement interactive command items with selection states and action handling.

<CodePreview 
  code={`import { useState } from "react";
import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
  CommandSeparator,
  CommandShortcut,
} from "@/components/ui/command";
import {
  Copy,
  Download,
  Edit,
  Share,
  Trash,
  Upload,
} from "lucide-react";

const actions = [
  { id: "copy", label: "Copy", icon: Copy, shortcut: "âŒ˜C" },
  { id: "edit", label: "Edit", icon: Edit, shortcut: "âŒ˜E" },
  { id: "download", label: "Download", icon: Download, shortcut: "âŒ˜D" },
  { id: "upload", label: "Upload", icon: Upload, shortcut: "âŒ˜U" },
  { id: "share", label: "Share", icon: Share, shortcut: "âŒ˜S" },
  { id: "delete", label: "Delete", icon: Trash, shortcut: "âŒ˜âŒ«" },
];

export default function CommandActions() {
  const [selectedAction, setSelectedAction] = useState<string | null>(null);

  const handleSelect = (actionId: string) => {
    setSelectedAction(actionId);
    // Perform action here
    console.log(\`Selected action: \${actionId}\`);
  };

  return (
    <Command className="rounded-lg border shadow-md max-w-md">
      <CommandInput placeholder="Search actions..." />
      <CommandList>
        <CommandEmpty>No actions found.</CommandEmpty>
        <CommandGroup heading="File Actions">
          {actions.slice(0, 3).map((action) => {
            const Icon = action.icon;
            return (
              <CommandItem
                key={action.id}
                onSelect={() => handleSelect(action.id)}
                className={selectedAction === action.id ? "bg-accent" : ""}
              >
                <Icon className="mr-2 h-4 w-4" />
                <span>{action.label}</span>
                <CommandShortcut>{action.shortcut}</CommandShortcut>
              </CommandItem>
            );
          })}
        </CommandGroup>
        <CommandSeparator />
        <CommandGroup heading="Other Actions">
          {actions.slice(3).map((action) => {
            const Icon = action.icon;
            return (
              <CommandItem
                key={action.id}
                onSelect={() => handleSelect(action.id)}
                className={selectedAction === action.id ? "bg-accent" : ""}
              >
                <Icon className="mr-2 h-4 w-4" />
                <span>{action.label}</span>
                <CommandShortcut>{action.shortcut}</CommandShortcut>
              </CommandItem>
            );
          })}
        </CommandGroup>
      </CommandList>
    </Command>
  );
}`} 
  language="tsx" 
  preview={<CommandActions />} 
/>

### Loading State

Show loading states while fetching search results or performing async operations.

<CodePreview 
  code={`import { useState, useEffect } from "react";
import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
} from "@/components/ui/command";
import { Skeleton } from "@/components/ui/skeleton";
import {
  Globe,
  Search,
  Star,
  TrendingUp,
} from "lucide-react";

interface SearchResult {
  id: string;
  title: string;
  description: string;
  icon: React.ComponentType<{ className?: string }>;
}

const mockResults: SearchResult[] = [
  {
    id: "1",
    title: "Popular repositories",
    description: "Trending on GitHub",
    icon: TrendingUp,
  },
  {
    id: "2",
    title: "Search the web",
    description: "Find anything online",
    icon: Globe,
  },
  {
    id: "3",
    title: "Starred items",
    description: "Your favorite content",
    icon: Star,
  },
  {
    id: "4",
    title: "Advanced search",
    description: "More search options",
    icon: Search,
  },
];

export default function CommandLoading() {
  const [loading, setLoading] = useState(false);
  const [results, setResults] = useState<SearchResult[]>([]);
  const [query, setQuery] = useState("");

  useEffect(() => {
    if (query.length > 0) {
      setLoading(true);
      // Simulate API call
      const timer = setTimeout(() => {
        setResults(mockResults.filter(result => 
          result.title.toLowerCase().includes(query.toLowerCase())
        ));
        setLoading(false);
      }, 1000);

      return () => clearTimeout(timer);
    } else {
      setResults([]);
      setLoading(false);
    }
  }, [query]);

  return (
    <Command className="rounded-lg border shadow-md max-w-md">
      <CommandInput 
        placeholder="Search..." 
        value={query}
        onValueChange={setQuery}
      />
      <CommandList>
        {loading ? (
          <CommandGroup>
            <div className="p-2 space-y-2">
              <Skeleton className="h-8 w-full" />
              <Skeleton className="h-8 w-full" />
              <Skeleton className="h-8 w-full" />
            </div>
          </CommandGroup>
        ) : (
          <>
            <CommandEmpty>No results found.</CommandEmpty>
            <CommandGroup heading="Results">
              {results.map((result) => {
                const Icon = result.icon;
                return (
                  <CommandItem key={result.id}>
                    <Icon className="mr-2 h-4 w-4" />
                    <div className="flex flex-col">
                      <span>{result.title}</span>
                      <span className="text-xs text-muted-foreground">
                        {result.description}
                      </span>
                    </div>
                  </CommandItem>
                );
              })}
            </CommandGroup>
          </>
        )}
      </CommandList>
    </Command>
  );
}`} 
  language="tsx" 
  preview={<CommandLoading />} 
/>

### Keyboard Navigation

Demonstrate keyboard shortcuts and navigation patterns within the command palette.

<CodePreview 
  code={`import { useState, useEffect } from "react";
import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
  CommandSeparator,
  CommandShortcut,
} from "@/components/ui/command";
import {
  ArrowLeft,
  ArrowRight,
  ArrowUp,
  ArrowDown,
  CornerDownLeft,
  X,
} from "lucide-react";

const keyboardShortcuts = [
  {
    key: "â†‘ / â†“",
    description: "Navigate items",
    icon: ArrowUp,
  },
  {
    key: "Enter",
    description: "Select item",
    icon: CornerDownLeft,
  },
  {
    key: "Escape",
    description: "Close dialog",
    icon: X,
  },
  {
    key: "â† / â†’",
    description: "Navigate groups",
    icon: ArrowLeft,
  },
];

const navigationItems = [
  { label: "Home", shortcut: "âŒ˜H" },
  { label: "Dashboard", shortcut: "âŒ˜D" },
  { label: "Projects", shortcut: "âŒ˜P" },
  { label: "Settings", shortcut: "âŒ˜," },
];

export default function CommandKeyboard() {
  const [selectedItem, setSelectedItem] = useState<string | null>(null);

  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.metaKey || e.ctrlKey) {
        switch (e.key) {
          case "h":
            e.preventDefault();
            setSelectedItem("Home");
            break;
          case "d":
            e.preventDefault();
            setSelectedItem("Dashboard");
            break;
          case "p":
            e.preventDefault();
            setSelectedItem("Projects");
            break;
          case ",":
            e.preventDefault();
            setSelectedItem("Settings");
            break;
        }
      }
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, []);

  return (
    <Command className="rounded-lg border shadow-md max-w-md">
      <CommandInput placeholder="Try keyboard shortcuts..." />
      <CommandList>
        <CommandEmpty>No results found.</CommandEmpty>
        <CommandGroup heading="Navigation">
          {navigationItems.map((item) => (
            <CommandItem
              key={item.label}
              onSelect={() => setSelectedItem(item.label)}
              className={selectedItem === item.label ? "bg-accent" : ""}
            >
              <span>{item.label}</span>
              <CommandShortcut>{item.shortcut}</CommandShortcut>
            </CommandItem>
          ))}
        </CommandGroup>
        <CommandSeparator />
        <CommandGroup heading="Keyboard Shortcuts">
          {keyboardShortcuts.map((shortcut) => {
            const Icon = shortcut.icon;
            return (
              <CommandItem key={shortcut.key}>
                <Icon className="mr-2 h-4 w-4" />
                <span>{shortcut.description}</span>
                <CommandShortcut>{shortcut.key}</CommandShortcut>
              </CommandItem>
            );
          })}
        </CommandGroup>
      </CommandList>
    </Command>
  );
}`} 
  language="tsx" 
  preview={<CommandKeyboard />} 
/>

### Styled Command

Customize the appearance of your command palette with custom styling and themes.

<CodePreview 
  code={`import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
  CommandSeparator,
} from "@/components/ui/command";
import {
  Palette,
  Brush,
  Droplets,
  Sun,
  Moon,
  Monitor,
} from "lucide-react";

const themes = [
  { name: "Light", icon: Sun, color: "bg-yellow-100 text-yellow-800" },
  { name: "Dark", icon: Moon, color: "bg-slate-100 text-slate-800" },
  { name: "System", icon: Monitor, color: "bg-blue-100 text-blue-800" },
];

const colors = [
  { name: "Red", icon: Droplets, color: "bg-red-100 text-red-800" },
  { name: "Blue", icon: Droplets, color: "bg-blue-100 text-blue-800" },
  { name: "Green", icon: Droplets, color: "bg-green-100 text-green-800" },
  { name: "Purple", icon: Droplets, color: "bg-purple-100 text-purple-800" },
];

export default function CommandStyled() {
  return (
    <Command className="rounded-lg border shadow-lg max-w-md bg-gradient-to-br from-purple-50 to-blue-50">
      <CommandInput 
        placeholder="Customize your theme..." 
        className="border-none bg-transparent"
      />
      <CommandList className="max-h-[400px]">
        <CommandEmpty>No customization options found.</CommandEmpty>
        <CommandGroup heading="ðŸŽ¨ Themes">
          {themes.map((theme) => {
            const Icon = theme.icon;
            return (
              <CommandItem key={theme.name} className="hover:bg-white/50">
                <Icon className="mr-2 h-4 w-4" />
                <span>{theme.name}</span>
                <div className={\`ml-auto h-3 w-3 rounded-full \${theme.color}\`} />
              </CommandItem>
            );
          })}
        </CommandGroup>
        <CommandSeparator className="bg-gradient-to-r from-purple-200 to-blue-200" />
        <CommandGroup heading="ðŸŒˆ Colors">
          {colors.map((color) => {
            const Icon = color.icon;
            return (
              <CommandItem key={color.name} className="hover:bg-white/50">
                <Icon className="mr-2 h-4 w-4" />
                <span>{color.name}</span>
                <div className={\`ml-auto h-3 w-3 rounded-full \${color.color}\`} />
              </CommandItem>
            );
          })}
        </CommandGroup>
        <CommandSeparator className="bg-gradient-to-r from-purple-200 to-blue-200" />
        <CommandGroup heading="âœ¨ Effects">
          <CommandItem className="hover:bg-white/50">
            <Palette className="mr-2 h-4 w-4" />
            <span>Custom Palette</span>
          </CommandItem>
          <CommandItem className="hover:bg-white/50">
            <Brush className="mr-2 h-4 w-4" />
            <span>Advanced Styling</span>
          </CommandItem>
        </CommandGroup>
      </CommandList>
    </Command>
  );
}`} 
  language="tsx" 
  preview={<CommandStyled />} 
/>

### Nested Navigation

Implement hierarchical navigation with breadcrumbs and back functionality.

<CodePreview 
  code={`import { useState } from "react";
import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
  CommandSeparator,
} from "@/components/ui/command";
import {
  ChevronRight,
  ArrowLeft,
  Folder,
  File,
  Settings,
  User,
  Bell,
  Shield,
  Palette,
  Globe,
} from "lucide-react";

interface MenuItem {
  id: string;
  label: string;
  icon: React.ComponentType<{ className?: string }>;
  children?: MenuItem[];
}

const menuItems: MenuItem[] = [
  {
    id: "files",
    label: "Files",
    icon: Folder,
    children: [
      { id: "documents", label: "Documents", icon: File },
      { id: "images", label: "Images", icon: File },
      { id: "videos", label: "Videos", icon: File },
    ],
  },
  {
    id: "settings",
    label: "Settings",
    icon: Settings,
    children: [
      { id: "profile", label: "Profile", icon: User },
      { id: "notifications", label: "Notifications", icon: Bell },
      { id: "security", label: "Security", icon: Shield },
      { id: "appearance", label: "Appearance", icon: Palette },
      { id: "language", label: "Language", icon: Globe },
    ],
  },
];

export default function CommandNested() {
  const [currentPath, setCurrentPath] = useState<string[]>([]);
  const [searchValue, setSearchValue] = useState("");

  const getCurrentItems = (): MenuItem[] => {
    let items = menuItems;
    for (const pathSegment of currentPath) {
      const item = items.find((item) => item.id === pathSegment);
      if (item?.children) {
        items = item.children;
      }
    }
    return items;
  };

  const handleItemSelect = (item: MenuItem) => {
    if (item.children) {
      setCurrentPath([...currentPath, item.id]);
      setSearchValue("");
    } else {
      console.log(\`Selected: \${item.label}\`);
    }
  };

  const handleBack = () => {
    setCurrentPath(currentPath.slice(0, -1));
    setSearchValue("");
  };

  const currentItems = getCurrentItems();
  const canGoBack = currentPath.length > 0;

  return (
    <Command className="rounded-lg border shadow-md max-w-md">
      <div className="flex items-center px-3 border-b">
        {canGoBack && (
          <button
            onClick={handleBack}
            className="mr-2 p-1 hover:bg-accent rounded"
          >
            <ArrowLeft className="h-4 w-4" />
          </button>
        )}
        <CommandInput
          placeholder={\`Search \${currentPath.length > 0 ? currentPath[currentPath.length - 1] : 'menu'}...\`}
          value={searchValue}
          onValueChange={setSearchValue}
          className="border-none"
        />
      </div>
      <CommandList>
        <CommandEmpty>No items found.</CommandEmpty>
        {currentPath.length > 0 && (
          <>
            <CommandGroup heading="Breadcrumb">
              <div className="px-2 py-1 text-xs text-muted-foreground">
                {currentPath.join(" > ")}
              </div>
            </CommandGroup>
            <CommandSeparator />
          </>
        )}
        <CommandGroup heading={currentPath.length > 0 ? "Items" : "Menu"}>
          {currentItems.map((item) => {
            const Icon = item.icon;
            const hasChildren = item.children && item.children.length > 0;
            return (
              <CommandItem
                key={item.id}
                onSelect={() => handleItemSelect(item)}
              >
                <Icon className="mr-2 h-4 w-4" />
                <span>{item.label}</span>
                {hasChildren && <ChevronRight className="ml-auto h-4 w-4" />}
              </CommandItem>
            );
          })}
        </CommandGroup>
      </CommandList>
    </Command>
  );
}`} 
  language="tsx" 
  preview={<CommandNested />} 
/>

### Advanced Features

Showcase advanced functionality including recent items, favorites, and time-based sorting.

<CodePreview 
  code={`import { useState, useEffect } from "react";
import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
  CommandSeparator,
  CommandShortcut,
} from "@/components/ui/command";
import {
  Clock,
  Star,
  Hash,
  AtSign,
  FileText,
  Users,
  MessageSquare,
  Calendar,
  Bookmark,
} from "lucide-react";

interface CommandItem {
  id: string;
  label: string;
  description?: string;
  icon: React.ComponentType<{ className?: string }>;
  shortcut?: string;
  category: string;
  lastUsed?: Date;
  isFavorite?: boolean;
}

const allItems: CommandItem[] = [
  {
    id: "new-doc",
    label: "New Document",
    description: "Create a new document",
    icon: FileText,
    shortcut: "âŒ˜N",
    category: "actions",
    lastUsed: new Date(Date.now() - 1000 * 60 * 30), // 30 minutes ago
  },
  {
    id: "team-chat",
    label: "Team Chat",
    description: "Open team discussion",
    icon: MessageSquare,
    shortcut: "âŒ˜T",
    category: "navigation",
    isFavorite: true,
    lastUsed: new Date(Date.now() - 1000 * 60 * 60), // 1 hour ago
  },
  {
    id: "calendar",
    label: "Calendar",
    description: "View your schedule",
    icon: Calendar,
    shortcut: "âŒ˜C",
    category: "navigation",
    isFavorite: true,
  },
  {
    id: "bookmarks",
    label: "Bookmarks",
    description: "Saved items",
    icon: Bookmark,
    category: "navigation",
    lastUsed: new Date(Date.now() - 1000 * 60 * 15), // 15 minutes ago
  },
  {
    id: "mention-user",
    label: "Mention User",
    description: "Tag someone in a comment",
    icon: AtSign,
    category: "actions",
  },
  {
    id: "add-tag",
    label: "Add Tag",
    description: "Organize with tags",
    icon: Hash,
    category: "actions",
  },
  {
    id: "team-members",
    label: "Team Members",
    description: "View team directory",
    icon: Users,
    category: "navigation",
  },
];

export default function CommandAdvanced() {
  const [searchValue, setSearchValue] = useState("");
  const [favorites, setFavorites] = useState<Set<string>>(
    new Set(allItems.filter(item => item.isFavorite).map(item => item.id))
  );
  const [lastUsedItems, setLastUsedItems] = useState<CommandItem[]>(
    allItems.filter(item => item.lastUsed).sort((a, b) => 
      (b.lastUsed?.getTime() || 0) - (a.lastUsed?.getTime() || 0)
    )
  );

  const toggleFavorite = (itemId: string) => {
    const newFavorites = new Set(favorites);
    if (newFavorites.has(itemId)) {
      newFavorites.delete(itemId);
    } else {
      newFavorites.add(itemId);
    }
    setFavorites(newFavorites);
  };

  const updateLastUsed = (item: CommandItem) => {
    const updatedItem = { ...item, lastUsed: new Date() };
    setLastUsedItems(prev => {
      const filtered = prev.filter(i => i.id !== item.id);
      return [updatedItem, ...filtered].slice(0, 5); // Keep only 5 recent items
    });
  };

  const formatTimeAgo = (date: Date) => {
    const now = new Date();
    const diffInMinutes = Math.floor((now.getTime() - date.getTime()) / (1000 * 60));
    
    if (diffInMinutes < 1) return "Just now";
    if (diffInMinutes < 60) return \`\${diffInMinutes}m ago\`;
    if (diffInMinutes < 1440) return \`\${Math.floor(diffInMinutes / 60)}h ago\`;
    return \`\${Math.floor(diffInMinutes / 1440)}d ago\`;
  };

  const filteredItems = allItems.filter(item =>
    item.label.toLowerCase().includes(searchValue.toLowerCase()) ||
    item.description?.toLowerCase().includes(searchValue.toLowerCase())
  );

  const favoriteItems = filteredItems.filter(item => favorites.has(item.id));
  const recentItems = lastUsedItems.filter(item => 
    filteredItems.some(filtered => filtered.id === item.id)
  );
  const otherItems = filteredItems.filter(item => 
    !favorites.has(item.id) && !recentItems.some(recent => recent.id === item.id)
  );

  return (
    <Command className="rounded-lg border shadow-md max-w-md">
      <CommandInput
        placeholder="Search commands..."
        value={searchValue}
        onValueChange={setSearchValue}
      />
      <CommandList>
        <CommandEmpty>No commands found.</CommandEmpty>
        
        {recentItems.length > 0 && (
          <>
            <CommandGroup heading="Recent">
              {recentItems.map((item) => {
                const Icon = item.icon;
                return (
                  <CommandItem
                    key={\`recent-\${item.id}\`}
                    onSelect={() => updateLastUsed(item)}
                  >
                    <Icon className="mr-2 h-4 w-4" />
                    <div className="flex flex-col flex-1">
                      <span>{item.label}</span>
                      {item.description && (
                        <span className="text-xs text-muted-foreground">
                          {item.description}
                        </span>
                      )}
                    </div>
                    <div className="flex items-center gap-2">
                      <span className="text-xs text-muted-foreground">
                        <Clock className="inline h-3 w-3 mr-1" />
                        {item.lastUsed && formatTimeAgo(item.lastUsed)}
                      </span>
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          toggleFavorite(item.id);
                        }}
                        className="p-1 hover:bg-accent rounded"
                      >
                        <Star 
                          className={\`h-3 w-3 \${favorites.has(item.id) ? 'fill-yellow-400 text-yellow-400' : 'text-muted-foreground'}\`} 
                        />
                      </button>
                      {item.shortcut && (
                        <CommandShortcut>{item.shortcut}</CommandShortcut>
                      )}
                    </div>
                  </CommandItem>
                );
              })}
            </CommandGroup>
            <CommandSeparator />
          </>
        )}

        {favoriteItems.length > 0 && (
          <>
            <CommandGroup heading="Favorites">
              {favoriteItems.map((item) => {
                const Icon = item.icon;
                return (
                  <CommandItem
                    key={\`favorite-\${item.id}\`}
                    onSelect={() => updateLastUsed(item)}
                  >
                    <Icon className="mr-2 h-4 w-4" />
                    <div className="flex flex-col flex-1">
                      <span>{item.label}</span>
                      {item.description && (
                        <span className="text-xs text-muted-foreground">
                          {item.description}
                        </span>
                      )}
                    </div>
                    <div className="flex items-center gap-2">
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          toggleFavorite(item.id);
                        }}
                        className="p-1 hover:bg-accent rounded"
                      >
                        <Star className="h-3 w-3 fill-yellow-400 text-yellow-400" />
                      </button>
                      {item.shortcut && (
                        <CommandShortcut>{item.shortcut}</CommandShortcut>
                      )}
                    </div>
                  </CommandItem>
                );
              })}
            </CommandGroup>
            <CommandSeparator />
          </>
        )}

        {otherItems.length > 0 && (
          <CommandGroup heading="All Commands">
            {otherItems.map((item) => {
              const Icon = item.icon;
              return (
                <CommandItem
                  key={item.id}
                  onSelect={() => updateLastUsed(item)}
                >
                  <Icon className="mr-2 h-4 w-4" />
                  <div className="flex flex-col flex-1">
                    <span>{item.label}</span>
                    {item.description && (
                      <span className="text-xs text-muted-foreground">
                        {item.description}
                      </span>
                    )}
                  </div>
                  <div className="flex items-center gap-2">
                    <button
                      onClick={(e) => {
                        e.stopPropagation();
                        toggleFavorite(item.id);
                      }}
                      className="p-1 hover:bg-accent rounded"
                    >
                      <Star className="h-3 w-3 text-muted-foreground" />
                    </button>
                    {item.shortcut && (
                      <CommandShortcut>{item.shortcut}</CommandShortcut>
                    )}
                  </div>
                </CommandItem>
              );
            })}
          </CommandGroup>
        )}
      </CommandList>
    </Command>
  );
}`} 
  language="tsx" 
  preview={<CommandAdvanced />} 
/>

## API Reference

### Command

The root command component that provides the command palette functionality.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `className` | `string` | - | Additional CSS classes |
| `shouldFilter` | `boolean` | `true` | Whether to filter items based on search |
| `filter` | `(value: string, search: string) => number` | - | Custom filter function |
| `defaultValue` | `string` | - | Default selected value |
| `value` | `string` | - | Controlled selected value |
| `onValueChange` | `(value: string) => void` | - | Callback when value changes |

### CommandDialog

A command palette wrapped in a dialog modal.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `open` | `boolean` | - | Whether the dialog is open |
| `onOpenChange` | `(open: boolean) => void` | - | Callback when open state changes |
| `children` | `ReactNode` | - | Dialog content |

### CommandInput

The search input for filtering command items.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `placeholder` | `string` | - | Input placeholder text |
| `value` | `string` | - | Controlled input value |
| `onValueChange` | `(value: string) => void` | - | Callback when input changes |
| `className` | `string` | - | Additional CSS classes |

### CommandList

Container for command items with scroll support.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `className` | `string` | - | Additional CSS classes |
| `children` | `ReactNode` | - | List content |

### CommandEmpty

Displayed when no command items match the search.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `className` | `string` | - | Additional CSS classes |
| `children` | `ReactNode` | - | Empty state content |

### CommandGroup

Groups related command items with an optional heading.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `heading` | `string` | - | Group heading text |
| `className` | `string` | - | Additional CSS classes |
| `children` | `ReactNode` | - | Group content |

### CommandItem

Individual selectable command item.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `value` | `string` | - | Item value for selection |
| `onSelect` | `(value: string) => void` | - | Callback when item is selected |
| `disabled` | `boolean` | `false` | Whether the item is disabled |
| `className` | `string` | - | Additional CSS classes |
| `children` | `ReactNode` | - | Item content |

### CommandSeparator

Visual separator between command groups.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `className` | `string` | - | Additional CSS classes |

### CommandShortcut

Displays keyboard shortcuts for command items.

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `className` | `string` | - | Additional CSS classes |
| `children` | `ReactNode` | - | Shortcut content |

## Keyboard Navigation

- **â†‘/â†“**: Navigate between items
- **Enter**: Select the highlighted item
- **Escape**: Close the command dialog
- **Tab**: Move focus out of the command palette
- **Type**: Filter items by typing

## Accessibility

The Command component follows WAI-ARIA guidelines:

- Uses proper ARIA roles and attributes
- Supports keyboard navigation
- Provides screen reader announcements
- Maintains focus management
- Includes proper labeling for all interactive elements

## Best Practices

1. **Use descriptive labels**: Make command items clear and actionable
2. **Group related items**: Use CommandGroup to organize similar commands
3. **Provide keyboard shortcuts**: Add shortcuts for frequently used commands
4. **Show loading states**: Use loading indicators for async operations
5. **Implement search**: Allow users to quickly find commands by typing
6. **Consider mobile**: Ensure the command palette works well on touch devices
7. **Limit items**: Don't overwhelm users with too many options at once

## Examples in Context

### Global Search

```tsx
function GlobalSearch() {
  const [open, setOpen] = useState(false)

  useEffect(() => {
    const down = (e: KeyboardEvent) => {
      if (e.key === "k" && (e.metaKey || e.ctrlKey)) {
        e.preventDefault()
        setOpen((open) => !open)
      }
    }
    document.addEventListener("keydown", down)
    return () => document.removeEventListener("keydown", down)
  }, [])

  return (
    <CommandDialog open={open} onOpenChange={setOpen}>
      <CommandInput placeholder="Search..." />
      <CommandList>
        <CommandEmpty>No results found.</CommandEmpty>
        <CommandGroup heading="Pages">
          <CommandItem>Dashboard</CommandItem>
          <CommandItem>Settings</CommandItem>
        </CommandGroup>
      </CommandList>
    </CommandDialog>
  )
}
```

### File Browser

```tsx
function FileBrowser() {
  return (
    <Command>
      <CommandInput placeholder="Search files..." />
      <CommandList>
        <CommandGroup heading="Recent Files">
          <CommandItem>
            <FileText className="mr-2 h-4 w-4" />
            document.pdf
          </CommandItem>
        </CommandGroup>
      </CommandList>
    </Command>
  )
}
```

## Dependencies

The Command component depends on:

- `cmdk` - The underlying command palette primitive
- `@radix-ui/react-dialog` - For the CommandDialog modal
- `lucide-react` - For icons in examples
- `class-variance-authority` - For variant management
- `clsx` - For conditional class names
- `tailwind-merge` - For merging Tailwind classes